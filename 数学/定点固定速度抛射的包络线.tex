% !TEX program = xelatex
% !TEX encoding = UTF-8
% ============================================
% 固定速度抛射的包络线
% 数学笔记 XeLaTeX 模板
% ============================================

\documentclass[a4paper,11pt]{ctexart}

\input{../mathnote-preamble.tex}

\renewcommand{\notetitle}{定点固定速度抛射的包络线}
\renewcommand{\noteauthor}{Gemini 数学组}
\renewcommand{\notedate}{\today}

\title{\Huge \bfseries \color{myblue} \notetitle}
\author{\noteauthor}
\date{\notedate}

\begin{document}

% 标题页
\maketitle

% 目录
\tableofcontents
\newpage

% ============================================
% 1. 引言与问题背景
% ============================================
\section{引言与问题背景}

\begin{definitionbox}{包络线}
\textbf{包络线（Envelope）}是指与一族曲线都相切的曲线。在几何上，包络线是这族曲线的“边界”，它恰好与族中的每一条曲线在某一点相切。

对于抛体运动，如果我们从同一点以相同的初速度 $v_0$ 但不同的抛射角 $\theta$ 抛出多个质点，这些质点的轨迹形成一族抛物线。这族抛物线的包络线就是一条特殊的曲线，它表示在给定初速度下，质点能够到达的所有位置点的边界。
\end{definitionbox}

\begin{center}
\begin{tikzpicture}[scale=2.0, x=2.5cm, y=6cm, >=Stealth]
    % 参数设置（先计算范围）
    \pgfmathsetmacro{\vzero}{3}
    \pgfmathsetmacro{\g}{9.8}
    \pgfmathsetmacro{\hmax}{\vzero*\vzero/(2*\g)}
    \pgfmathsetmacro{\xmaxenv}{\vzero*\vzero/\g}
    
    % 坐标轴
    \draw[->, thick, black] (-0.1,0) -- (1.1*\xmaxenv,0) node[right, font=\normalsize] {$x$ (m)};
    \draw[->, thick, black] (0,-0.05) -- (0,1.1*\hmax) node[above, font=\normalsize] {$y$ (m)};
    \node[black] at (0,0) [below left, font=\normalsize] {$O$};
    
    % 网格线（辅助）
    \draw[gray!20, very thin] (0,0) grid (1.05*\xmaxenv,1.05*\hmax);
    
    % 抛射点
    \fill[myred] (0,0) circle (2pt);
    \node[myred, below left, font=\normalsize] at (0,0) {抛射点};
    
    % 多条不同角度的轨迹（示意）
    \foreach \angle in {10, 20, 30, 40, 50, 60, 70, 80}
    {
        \pgfmathsetmacro{\tantheta}{tan(\angle)}
        \pgfmathsetmacro{\costheta}{cos(\angle)}
        \pgfmathsetmacro{\sintheta}{sin(\angle)}
        \pgfmathsetmacro{\xmax}{2*\vzero*\vzero*\sintheta*\costheta/\g}
        
        \draw[myblue!35, thin, domain=0:\xmax, samples=80] 
            plot (\x, {\x*\tantheta - \g*\x*\x/(2*\vzero*\vzero*\costheta*\costheta)});
    }
    
    % 特殊角度轨迹（加粗显示）
    \foreach \angle in {30, 45, 60}
    {
        \pgfmathsetmacro{\tantheta}{tan(\angle)}
        \pgfmathsetmacro{\costheta}{cos(\angle)}
        \pgfmathsetmacro{\sintheta}{sin(\angle)}
        \pgfmathsetmacro{\xmax}{2*\vzero*\vzero*\sintheta*\costheta/\g}
        
        \draw[myblue!70, semithick, domain=0:\xmax, samples=80] 
            plot (\x, {\x*\tantheta - \g*\x*\x/(2*\vzero*\vzero*\costheta*\costheta)});
    }
    
    % 包络线（抛物线，粗线）
    \draw[myred, very thick, line width=2pt, domain=0:\xmaxenv, samples=150] 
        plot (\x, {\hmax - \g*\x*\x/(2*\vzero*\vzero)});
    
    % 包络线标注
    \node[myred, above right, font=\normalsize\bfseries] at (0.6*\xmaxenv, 0.6*\hmax) {包络线};
    \draw[myred, ->, thick] (0.55*\xmaxenv, 0.55*\hmax) -- (0.45*\xmaxenv, 0.45*\hmax);
    
    % 轨迹族标注
    \node[myblue, right, font=\normalsize] at (0.9*\xmaxenv, 0.2*\hmax) {轨迹族};
    
    % 添加一些关键点的标注
    \fill[mygreen] (0, \hmax) circle (1.5pt);
    \draw[dashed, mygreen!60] (0, 0) -- (0, \hmax);
    \node[mygreen, left, font=\small] at (0, \hmax) {$\frac{v_0^2}{2g}$};
\end{tikzpicture}
\captionof{figure}{包络线的直观理解：多条轨迹的边界}
\end{center}

\subsection{问题的物理意义}

在抛体运动中，如果我们固定初速度 $v_0$，只改变抛射角 $\theta$，那么：
\begin{itemize}
    \item 不同的抛射角对应不同的轨迹抛物线
    \item 这些轨迹形成一个“轨迹族”
    \item 包络线表示在给定初速度下，质点能够到达的所有位置点的\textbf{边界}
    \item 包络线内部的区域是“可达区域”，外部的区域是“不可达区域”
\end{itemize}

这个问题在军事、体育、工程等领域都有重要应用，例如：
\begin{itemize}
    \item 确定炮弹的射程范围
    \item 分析投掷物体的可达区域
    \item 设计安全防护区域
\end{itemize}

% ============================================
% 2. 抛体运动基础回顾
% ============================================
\section{抛体运动基础回顾}

\begin{definitionbox}{抛体运动的参数方程}
设质点从原点 $O(0,0)$ 以初速度 $v_0$、抛射角 $\theta$（与水平方向夹角）抛出，重力加速度为 $g$（方向竖直向下）。

\textbf{运动分解：}
\begin{itemize}
    \item 水平方向：匀速直线运动，初速度 $v_{0x} = v_0\cos\theta$
    \item 竖直方向：匀变速直线运动，初速度 $v_{0y} = v_0\sin\theta$，加速度 $-g$
\end{itemize}

\textbf{参数方程（以时间 $t$ 为参数）：}
\begin{align}
    x(t) &= v_0\cos\theta \cdot t \label{eq:x}\\
    y(t) &= v_0\sin\theta \cdot t - \frac{1}{2}gt^2 \label{eq:y}
\end{align}

其中 $t \geq 0$，且 $y(t) \geq 0$（落地前）。
\end{definitionbox}

\begin{center}
\begin{tikzpicture}[scale=4.0, x=2.5cm, y=4cm, >=Stealth]
    % 参数设置（先计算范围）
    \pgfmathsetmacro{\vzero}{2}
    \pgfmathsetmacro{\g}{9.8}
    \pgfmathsetmacro{\angle}{40}
    \pgfmathsetmacro{\tantheta}{tan(\angle)}
    \pgfmathsetmacro{\costheta}{cos(\angle)}
    \pgfmathsetmacro{\sintheta}{sin(\angle)}
    \pgfmathsetmacro{\xmax}{2*\vzero*\vzero*\sintheta*\costheta/\g}
    \pgfmathsetmacro{\ymax}{\vzero*\vzero*\sintheta*\sintheta/(2*\g)}
    
    % 坐标轴
    \draw[->, thick, black] (-0.1,0) -- (1.1*\xmax,0) node[right, font=\normalsize] {$x$ (m)};
    \draw[->, thick, black] (0,-0.05) -- (0,1.2*\ymax) node[above, font=\normalsize] {$y$ (m)};
    \node[black] at (0,0) [below left, font=\normalsize] {$O$};
    
    % 网格线（辅助）
    \draw[gray!20, very thin] (0,0) grid (1.05*\xmax,1.15*\ymax);
    
    % 抛射点
    \fill[myred] (0,0) circle (1.5pt);
    
    % 速度矢量分解（缩短箭头长度）
    \pgfmathsetmacro{\vlen}{0.5}
    \pgfmathsetmacro{\vx}{\vlen*cos(\angle)}
    \pgfmathsetmacro{\vy}{\vlen*sin(\angle)}
    
    % 总速度矢量
    \draw[->, myred, very thick, line width=2.5pt] (0,0) -- (\vx, \vy);
    \node[myred, above left, font=\normalsize\bfseries] at (0.5*\vx, 0.5*\vy) {$v_0$};
    
    % 水平分量
    \draw[->, myblue, thick, line width=2pt] (0,0) -- (\vx, 0);
    \node[myblue, below, font=\normalsize] at (0.5*\vx, 0) {$v_{0x} = v_0\cos\theta$};
    
    % 竖直分量
    \draw[->, mygreen, thick, line width=2pt] (\vx, 0) -- (\vx, \vy);
    \node[mygreen, right, font=\normalsize] at (\vx, 0.5*\vy) {$v_{0y} = v_0\sin\theta$};
    
    % 辅助线（虚线）
    \draw[dashed, gray!50] (\vx, 0) -- (\vx, \vy);
    \draw[dashed, gray!50] (0, \vy) -- (\vx, \vy);
    
    % 角度标注
    \draw[myorange, thick] (0.35, 0) arc (0:\angle:0.35);
    \node[myorange, font=\normalsize] at (0.5, 0.12) {$\theta$};
    
    % 轨迹（抛物线）
    \draw[myorange, very thick, line width=2pt, domain=0:\xmax, samples=120] 
        plot (\x, {\x*\tantheta - \g*\x*\x/(2*\vzero*\vzero*\costheta*\costheta)});
    
    % 关键点标注
    \fill[myred] (0.5*\xmax, \ymax) circle (2pt);
    \draw[dashed, myred!60] (0.5*\xmax, 0) -- (0.5*\xmax, \ymax);
    \draw[dashed, myred!60] (0, \ymax) -- (0.5*\xmax, \ymax);
    \node[myred, above, font=\normalsize] at (0.5*\xmax, \ymax) {最高点};
    \node[myred, below, font=\small] at (0.5*\xmax, 0) {$R/2$};
    \node[myred, left, font=\small] at (0, \ymax) {$H$};
    
    \fill[myred] (\xmax, 0) circle (2pt);
    \draw[dashed, myred!60] (\xmax, 0) -- (\xmax, 0.1);
    \node[myred, below right, font=\normalsize] at (\xmax, 0) {落地点};
    \node[myred, below, font=\small] at (\xmax, 0) {$R$};
    
    % 轨迹标注
    \node[myorange, right, font=\normalsize\bfseries] at (0.7*\xmax, 0.5*\ymax) {轨迹};
\end{tikzpicture}
\captionof{figure}{抛体运动的速度分解与轨迹}
\end{center}

\subsection{轨迹方程}

从参数方程 \eqref{eq:x} 和 \eqref{eq:y} 中消去参数 $t$，得到轨迹方程：

由 $x = v_0\cos\theta \cdot t$ 得 $t = \frac{x}{v_0\cos\theta}$，代入 $y$ 的表达式：

\begin{align}
    y &= v_0\sin\theta \cdot \frac{x}{v_0\cos\theta} - \frac{1}{2}g\left(\frac{x}{v_0\cos\theta}\right)^2 \nonumber\\
    &= x\tan\theta - \frac{gx^2}{2v_0^2\cos^2\theta} \nonumber\\
    &= x\tan\theta - \frac{gx^2}{2v_0^2}(1 + \tan^2\theta) \label{eq:trajectory}
\end{align}

这是一个关于 $x$ 的二次函数，轨迹为抛物线。

\textbf{重要结论：}
\begin{itemize}
    \item 射程（水平距离）：$R = \frac{v_0^2\sin(2\theta)}{g}$，当 $\theta = 45°$ 时取得最大值 $R_{\max} = \frac{v_0^2}{g}$
    \item 最大高度：$H = \frac{v_0^2\sin^2\theta}{2g}$，当 $\theta = 90°$ 时取得最大值 $H_{\max} = \frac{v_0^2}{2g}$
\end{itemize}

% ============================================
% 3. 固定速度抛射的轨迹族
% ============================================
\section{固定速度抛射的轨迹族}

当我们固定初速度 $v_0$，让抛射角 $\theta$ 变化时，得到一族轨迹曲线。

\begin{definitionbox}{轨迹族}
对于固定的初速度 $v_0$，抛射角 $\theta$ 作为参数，轨迹方程 \eqref{eq:trajectory} 可以写成：
\begin{equation}
    y = x\tan\theta - \frac{gx^2}{2v_0^2}(1 + \tan^2\theta), \quad \theta \in \left(0, \frac{\pi}{2}\right) \label{eq:family}
\end{equation}

这表示一个以 $\theta$（或 $\tan\theta$）为参数的曲线族。每条曲线对应一个特定的抛射角。
\end{definitionbox}

\begin{center}
\begin{tikzpicture}[scale=2.0, x=2.5cm, y=6cm, >=Stealth]
    % 参数设置（先计算范围）
    \pgfmathsetmacro{\vzero}{3}
    \pgfmathsetmacro{\g}{9.8}
    \pgfmathsetmacro{\hmax}{\vzero*\vzero/(2*\g)}
    \pgfmathsetmacro{\xmaxenv}{\vzero*\vzero/\g}
    
    % 坐标轴
    \draw[->, thick, black] (-0.1,0) -- (1.1*\xmaxenv,0) node[right, font=\normalsize] {$x$ (m)};
    \draw[->, thick, black] (0,-0.05) -- (0,1.1*\hmax) node[above, font=\normalsize] {$y$ (m)};
    \node[black] at (0,0) [below left, font=\normalsize] {$O$};
    
    % 网格线（辅助）
    \draw[gray!20, very thin] (0,0) grid (1.05*\xmaxenv,1.05*\hmax);
    
    % 抛射点
    \fill[myred] (0,0) circle (2pt);
    \node[myred, below left, font=\small] at (0,0) {抛射点};
    
    % 多条不同角度的轨迹
    \foreach \angle in {10, 15, 20, 25, 30, 35, 40, 50, 55, 60, 65, 70, 75, 80}
    {
        \pgfmathsetmacro{\tantheta}{tan(\angle)}
        \pgfmathsetmacro{\costheta}{cos(\angle)}
        \pgfmathsetmacro{\sintheta}{sin(\angle)}
        \pgfmathsetmacro{\xmax}{2*\vzero*\vzero*\sintheta*\costheta/\g}
        
        \draw[myblue!40, thin, domain=0:\xmax, samples=60] 
            plot (\x, {\x*\tantheta - \g*\x*\x*(1+\tantheta*\tantheta)/(2*\vzero*\vzero)});
    }
    
    % 特殊角度轨迹（加粗显示）
    % 30度和60度
    \foreach \angle in {30, 60}
    {
        \pgfmathsetmacro{\tantheta}{tan(\angle)}
        \pgfmathsetmacro{\costheta}{cos(\angle)}
        \pgfmathsetmacro{\sintheta}{sin(\angle)}
        \pgfmathsetmacro{\xmax}{2*\vzero*\vzero*\sintheta*\costheta/\g}
        
        \draw[myblue!70, semithick, domain=0:\xmax, samples=80] 
            plot (\x, {\x*\tantheta - \g*\x*\x*(1+\tantheta*\tantheta)/(2*\vzero*\vzero)});
    }
    
    % 45度（特殊颜色）
    \pgfmathsetmacro{\angle}{45}
    \pgfmathsetmacro{\tantheta}{tan(\angle)}
    \pgfmathsetmacro{\costheta}{cos(\angle)}
    \pgfmathsetmacro{\sintheta}{sin(\angle)}
    \pgfmathsetmacro{\xmax}{2*\vzero*\vzero*\sintheta*\costheta/\g}
    \draw[mygreen, thick, line width=1.5pt, domain=0:\xmax, samples=80] 
        plot (\x, {\x*\tantheta - \g*\x*\x*(1+\tantheta*\tantheta)/(2*\vzero*\vzero)});
    
    % 45度角标注
    \pgfmathsetmacro{\angle}{45}
    \pgfmathsetmacro{\tantheta}{tan(\angle)}
    \pgfmathsetmacro{\sintheta}{sin(\angle)}
    \pgfmathsetmacro{\costheta}{cos(\angle)}
    \pgfmathsetmacro{\xmax}{2*\vzero*\vzero*\sintheta*\costheta/\g}
    \pgfmathsetmacro{\ymax}{\vzero*\vzero*\sintheta*\sintheta/(2*\g)}
    \node[mygreen, above, font=\normalsize\bfseries] at (0.5*\xmax, \ymax) {$\theta=45°$};
    
    % 其他角度标注
    \pgfmathsetmacro{\angle}{30}
    \pgfmathsetmacro{\tantheta}{tan(\angle)}
    \pgfmathsetmacro{\sintheta}{sin(\angle)}
    \pgfmathsetmacro{\costheta}{cos(\angle)}
    \pgfmathsetmacro{\xmax}{2*\vzero*\vzero*\sintheta*\costheta/\g}
    \pgfmathsetmacro{\ymax}{\vzero*\vzero*\sintheta*\sintheta/(2*\g)}
    \node[myblue, above left, font=\small] at (0.5*\xmax, \ymax) {$\theta=30°$};
    
    \pgfmathsetmacro{\angle}{60}
    \pgfmathsetmacro{\tantheta}{tan(\angle)}
    \pgfmathsetmacro{\sintheta}{sin(\angle)}
    \pgfmathsetmacro{\costheta}{cos(\angle)}
    \pgfmathsetmacro{\xmax}{2*\vzero*\vzero*\sintheta*\costheta/\g}
    \pgfmathsetmacro{\ymax}{\vzero*\vzero*\sintheta*\sintheta/(2*\g)}
    \node[myblue, above right, font=\small] at (0.5*\xmax, \ymax) {$\theta=60°$};
    
    % 标注
    \node[myblue, right, font=\normalsize] at (0.9*\xmaxenv, 0.3*\hmax) {轨迹族};
\end{tikzpicture}
\captionof{figure}{固定初速度 $v_0$ 下不同抛射角的轨迹族}
\end{center}

\subsection{轨迹族的特点}

观察轨迹族，我们可以发现：
\begin{itemize}
    \item 所有轨迹都从同一点 $(0,0)$ 出发
    \item 不同角度的轨迹有不同的射程和最大高度
    \item 这些轨迹之间存在一条\textbf{包络线}，它是所有轨迹的边界
    \item 包络线内部的区域是可达区域，外部是不可达区域
\end{itemize}

% ============================================
% 4. 包络线的数学推导
% ============================================
\section{包络线的数学推导}

\begin{definitionbox}{包络线的数学定义}
设曲线族由方程 $F(x, y, \alpha) = 0$ 给出，其中 $\alpha$ 是参数。如果存在一条曲线 $C$，使得：
\begin{enumerate}
    \item $C$ 上的每一点都在族中某条曲线上
    \item $C$ 在每一点都与族中经过该点的曲线相切
\end{enumerate}
则称 $C$ 为该曲线族的\textbf{包络线}。

包络线的求法：联立方程组
\begin{equation}
    \begin{cases}
        F(x, y, \alpha) = 0 \\
        \frac{\partial F}{\partial \alpha}(x, y, \alpha) = 0
    \end{cases}
\end{equation}
消去参数 $\alpha$，即可得到包络线的方程。
\end{definitionbox}

\subsection{包络线的推导过程}

对于抛体运动的轨迹族，我们使用 $\tan\theta$ 作为参数会更方便。设 $k = \tan\theta$，则轨迹方程 \eqref{eq:family} 变为：

\begin{equation}
    F(x, y, k) = y - xk + \frac{gx^2}{2v_0^2}(1 + k^2) = 0 \label{eq:F}
\end{equation}

对参数 $k$ 求偏导数：

\begin{equation}
    \frac{\partial F}{\partial k} = -x + \frac{gx^2}{2v_0^2} \cdot 2k = -x + \frac{gx^2k}{v_0^2} = 0 \label{eq:partial}
\end{equation}

由 \eqref{eq:partial} 得：
\begin{equation}
    -x + \frac{gx^2k}{v_0^2} = 0 \quad \Rightarrow \quad x\left(-1 + \frac{gxk}{v_0^2}\right) = 0
\end{equation}

当 $x = 0$ 时，对应抛射点，不是包络线上的点（除起点外）。因此：
\begin{equation}
    -1 + \frac{gxk}{v_0^2} = 0 \quad \Rightarrow \quad k = \frac{v_0^2}{gx} \label{eq:k}
\end{equation}

将 \eqref{eq:k} 代入 \eqref{eq:F}：

\begin{align}
    y &= x \cdot \frac{v_0^2}{gx} - \frac{gx^2}{2v_0^2}\left(1 + \left(\frac{v_0^2}{gx}\right)^2\right) \nonumber\\
    &= \frac{v_0^2}{g} - \frac{gx^2}{2v_0^2}\left(1 + \frac{v_0^4}{g^2x^2}\right) \nonumber\\
    &= \frac{v_0^2}{g} - \frac{gx^2}{2v_0^2} - \frac{gx^2}{2v_0^2} \cdot \frac{v_0^4}{g^2x^2} \nonumber\\
    &= \frac{v_0^2}{g} - \frac{gx^2}{2v_0^2} - \frac{v_0^2}{2g} \nonumber\\
    &= \frac{v_0^2}{2g} - \frac{gx^2}{2v_0^2}
\end{align}

\begin{theorembox}{抛体运动轨迹族的包络线方程}
从同一点以固定初速度 $v_0$、不同抛射角 $\theta$ 抛出的质点，其轨迹族的包络线方程为：
\begin{equation}
    y = \frac{v_0^2}{2g} - \frac{gx^2}{2v_0^2} \label{eq:envelope}
\end{equation}

这是一个开口向下的抛物线，其性质为：
\begin{itemize}
    \item 顶点：$\left(0, \frac{v_0^2}{2g}\right)$，这是竖直上抛能达到的最大高度
    \item 对称轴：$x = 0$（$y$ 轴）
    \item 与 $x$ 轴的交点：$x = \pm \frac{v_0^2}{g}$，这是水平抛射的最大射程
\end{itemize}
\end{theorembox}

\subsection{推导方法的说明}

我们也可以直接从轨迹方程出发，使用另一种方法：

将轨迹方程 \eqref{eq:trajectory} 整理为关于 $\tan\theta$ 的二次方程：
\begin{equation}
    \frac{gx^2}{2v_0^2}\tan^2\theta - x\tan\theta + \left(y + \frac{gx^2}{2v_0^2}\right) = 0
\end{equation}

对于给定的点 $(x, y)$，如果它位于某条轨迹上，则上述关于 $\tan\theta$ 的方程有实数解，判别式 $\Delta \geq 0$：

\begin{align}
    \Delta &= x^2 - 4 \cdot \frac{gx^2}{2v_0^2} \cdot \left(y + \frac{gx^2}{2v_0^2}\right) \nonumber\\
    &= x^2 - \frac{2gx^2}{v_0^2}\left(y + \frac{gx^2}{2v_0^2}\right) \nonumber\\
    &= x^2 - \frac{2gx^2y}{v_0^2} - \frac{g^2x^4}{v_0^4} \geq 0
\end{align}

整理得：
\begin{equation}
    y \leq \frac{v_0^2}{2g} - \frac{gx^2}{2v_0^2}
\end{equation}

等号成立时，点 $(x, y)$ 恰好在包络线上，这与 \eqref{eq:envelope} 一致。

% ============================================
% 5. 包络线的性质与应用
% ============================================
\section{包络线的性质与应用}

\subsection{包络线的几何性质}

\begin{center}
\begin{tikzpicture}[scale=2.0, x=2.5cm, y=6cm, >=Stealth]
    % 参数设置（先计算范围）
    \pgfmathsetmacro{\vzero}{3}
    \pgfmathsetmacro{\g}{9.8}
    \pgfmathsetmacro{\hmax}{\vzero*\vzero/(2*\g)}
    \pgfmathsetmacro{\xmax}{\vzero*\vzero/\g}
    
    % 坐标轴
    \draw[->, thick, black] (-1.1*\xmax,0) -- (1.1*\xmax,0) node[right, font=\normalsize] {$x$ (m)};
    \draw[->, thick, black] (0,-0.05) -- (0,1.1*\hmax) node[above, font=\normalsize] {$y$ (m)};
    \node[black] at (0,0) [below left, font=\normalsize] {$O$};
    
    % 网格线（辅助）
    \draw[gray!20, very thin] (-1.05*\xmax,0) grid (1.05*\xmax,1.05*\hmax);
    
    % 多条轨迹（较淡，作为背景）
    \foreach \angle in {5, 10, 15, 20, 25, 30, 35, 40, 45, 50, 55, 60, 65, 70, 75, 80, 85}
    {
        \pgfmathsetmacro{\tantheta}{tan(\angle)}
        \pgfmathsetmacro{\costheta}{cos(\angle)}
        \pgfmathsetmacro{\sintheta}{sin(\angle)}
        \pgfmathsetmacro{\xmaxtraj}{2*\vzero*\vzero*\sintheta*\costheta/\g}
        
        \draw[myblue!25, very thin, domain=0:\xmaxtraj, samples=60] 
            plot (\x, {\x*\tantheta - \g*\x*\x*(1+\tantheta*\tantheta)/(2*\vzero*\vzero)});
    }
    
    % 对称的轨迹（负x方向）
    \foreach \angle in {5, 10, 15, 20, 25, 30, 35, 40, 45, 50, 55, 60, 65, 70, 75, 80, 85}
    {
        \pgfmathsetmacro{\tantheta}{tan(\angle)}
        \pgfmathsetmacro{\costheta}{cos(\angle)}
        \pgfmathsetmacro{\sintheta}{sin(\angle)}
        \pgfmathsetmacro{\xmaxtraj}{2*\vzero*\vzero*\sintheta*\costheta/\g}
        
        \draw[myblue!25, very thin, domain=0:\xmaxtraj, samples=60] 
            plot (-\x, {\x*\tantheta - \g*\x*\x*(1+\tantheta*\tantheta)/(2*\vzero*\vzero)});
    }
    
    % 包络线（粗线，最上层）
    \draw[myred, very thick, line width=2.5pt, domain=-\xmax:\xmax, samples=150] 
        plot (\x, {\hmax - \g*\x*\x/(2*\vzero*\vzero)});
    
    % 抛射点
    \fill[myred] (0,0) circle (2pt);
    \node[myred, below left, font=\small] at (0,0) {抛射点};
    
    % 标注顶点
    \fill[myred] (0, \hmax) circle (2.5pt);
    \draw[dashed, myred!60, thick] (0, 0) -- (0, \hmax);
    \node[myred, left, font=\normalsize] at (0, 0.5*\hmax) {$\frac{v_0^2}{2g}$};
    \node[myred, above, font=\normalsize\bfseries] at (0, \hmax) {顶点};
    
    % 标注与x轴交点
    \fill[myred] (\xmax, 0) circle (2pt);
    \fill[myred] (-\xmax, 0) circle (2pt);
    \draw[dashed, myred!60, thick] (\xmax, 0) -- (\xmax, 0.08);
    \draw[dashed, myred!60, thick] (-\xmax, 0) -- (-\xmax, 0.08);
    \node[black, below, font=\normalsize] at (\xmax, 0) {$\frac{v_0^2}{g}$};
    \node[black, below, font=\normalsize] at (-\xmax, 0) {$-\frac{v_0^2}{g}$};
    
    % 标注
    \node[mygreen, right, font=\normalsize\bfseries] at (0.4*\xmax, 0.4*\hmax) {可达区域};
    \node[myred, above, font=\normalsize\bfseries] at (0, 0.8*\hmax) {包络线};
    
    % 添加对称轴标注
    \draw[<->, mypurple!60, thick] (-0.15*\xmax, 0.15*\hmax) -- (0.15*\xmax, 0.15*\hmax);
    \node[mypurple, above, font=\small] at (0, 0.15*\hmax) {对称轴};
\end{tikzpicture}
\captionof{figure}{包络线的几何性质与可达区域}
\end{center}

\begin{theorembox}{包络线的几何性质}
包络线 $y = \frac{v_0^2}{2g} - \frac{gx^2}{2v_0^2}$ 具有以下性质：

\begin{enumerate}
    \item \textbf{顶点}：$\left(0, \frac{v_0^2}{2g}\right)$
    \begin{itemize}
        \item 这是竖直上抛（$\theta = 90°$）能达到的最大高度
        \item 也是所有轨迹中能达到的最高点
    \end{itemize}
    
    \item \textbf{对称轴}：$x = 0$（$y$ 轴）
    \begin{itemize}
        \item 包络线关于 $y$ 轴对称
        \item 这反映了抛体运动的对称性
    \end{itemize}
    
    \item \textbf{与坐标轴的交点}：
    \begin{itemize}
        \item 与 $y$ 轴交点：$(0, \frac{v_0^2}{2g})$
        \item 与 $x$ 轴交点：$(\pm \frac{v_0^2}{g}, 0)$
        \item 水平距离 $\frac{v_0^2}{g}$ 是水平抛射（$\theta = 0°$）的最大射程
    \end{itemize}
    
    \item \textbf{开口方向}：向下
    \begin{itemize}
        \item 包络线是开口向下的抛物线
        \item 包络线内部的区域是可达区域
    \end{itemize}
\end{enumerate}
\end{theorembox}

\subsection{物理意义}

包络线的物理意义非常重要：

\begin{itemize}
    \item \textbf{可达区域的边界}：包络线内部的区域表示在给定初速度 $v_0$ 下，质点能够到达的所有位置点
    \item \textbf{不可达区域}：包络线外部的区域表示无论以什么角度抛射，都无法到达
    \item \textbf{最优抛射角}：包络线上的每个点都对应一个特定的抛射角，这个角度是到达该点的唯一角度（或两个对称角度）
\end{itemize}

\begin{center}
\begin{tikzpicture}[scale=2.0, x=2.5cm, y=2.5cm, >=Stealth]
    % 参数设置
    \pgfmathsetmacro{\vlen}{1.4}
    \pgfmathsetmacro{\xmax}{2.0}
    \pgfmathsetmacro{\ymax}{2.0}
    
    % 坐标轴
    \draw[->, thick, black] (-0.1,0) -- (\xmax,0) node[right, font=\normalsize] {$x$};
    \draw[->, thick, black] (0,-0.1) -- (0,\ymax) node[above, font=\normalsize] {$y$};
    \node[black] at (0,0) [below left, font=\normalsize] {$O$};
    
    % 网格线（辅助）
    \draw[gray!20, very thin] (0,0) grid (\xmax,\ymax);
    
    % 抛射点
    \fill[myred] (0,0) circle (1.5pt);
    \node[myred, below left, font=\small] at (0,0) {抛射点};
    
    % 参数设置
    \pgfmathsetmacro{\vlen}{1.4}
    
    % 多个不同角度的速度矢量（较淡）
    \foreach \angle in {10, 20, 30, 40, 50, 60, 70, 80}
    {
        \pgfmathsetmacro{\vx}{\vlen*cos(\angle)}
        \pgfmathsetmacro{\vy}{\vlen*sin(\angle)}
        
        \draw[->, myblue!40, semithick] (0,0) -- (\vx, \vy);
    }
    
    % 特殊角度的速度矢量（加粗）
    \foreach \angle in {15, 30, 45, 60, 75}
    {
        \pgfmathsetmacro{\vx}{\vlen*cos(\angle)}
        \pgfmathsetmacro{\vy}{\vlen*sin(\angle)}
        
        \draw[->, myblue!70, thick] (0,0) -- (\vx, \vy);
        
        % 分解线（虚线）
        \draw[mygreen!40, thin, dashed] (0,0) -- (\vx, 0);
        \draw[myorange!40, thin, dashed] (\vx, 0) -- (\vx, \vy);
    }
    
    % 主要标注（45度角）
    \pgfmathsetmacro{\angle}{45}
    \pgfmathsetmacro{\vx}{\vlen*cos(\angle)}
    \pgfmathsetmacro{\vy}{\vlen*sin(\angle)}
    
    \draw[->, myred, very thick, line width=2.5pt] (0,0) -- (\vx, \vy);
    \node[myred, above left, font=\normalsize\bfseries] at (0.5*\vx, 0.5*\vy) {$v_0$};
    
    \draw[->, mygreen, thick, line width=2pt] (0,0) -- (\vx, 0);
    \node[mygreen, below, font=\normalsize] at (0.5*\vx, 0) {$v_0\cos\theta$};
    
    \draw[->, myorange, thick, line width=2pt] (\vx, 0) -- (\vx, \vy);
    \node[myorange, right, font=\normalsize] at (\vx, 0.5*\vy) {$v_0\sin\theta$};
    
    % 角度标注
    \draw[myorange, thick] (0.3, 0) arc (0:\angle:0.3);
    \node[myorange, font=\normalsize] at (0.45, 0.12) {$\theta$};
    
    % 图例
    \node[myblue, right, font=\normalsize] at (1.3, 1.8) {不同角度的初速度};
    \draw[->, mygreen, thick] (1.1, 1.5) -- (1.5, 1.5);
    \node[mygreen, right, font=\normalsize] at (1.5, 1.5) {水平分量};
    \draw[->, myorange, thick] (1.1, 1.2) -- (1.5, 1.2);
    \node[myorange, right, font=\normalsize] at (1.5, 1.2) {竖直分量};
    
    % 添加速度大小相等的说明（1/4扇形）
    \draw[myblue!60, dashed, thick] (0,0) -- (\vlen, 0) arc (0:90:\vlen) -- (0,0);
    \node[myblue, right, font=\small] at (1.0, 0.2) {所有速度大小相等};
\end{tikzpicture}
\captionof{figure}{不同抛射角的速度分解}
\end{center}

% ============================================
% 6. 例题与应用
% ============================================
\section{例题与应用}

\begin{examplebox}{例题1：求包络线方程}
\textbf{题目：}从原点以初速度 $v_0 = 20\text{ m/s}$ 抛出质点，重力加速度 $g = 10\text{ m/s}^2$。求所有可能轨迹的包络线方程，并确定可达区域。

\textbf{解：}

\textbf{步骤1：}写出轨迹族方程

设抛射角为 $\theta$，轨迹方程为：
\[ y = x\tan\theta - \frac{gx^2}{2v_0^2}(1 + \tan^2\theta) \]

代入 $v_0 = 20$，$g = 10$：
\[ y = x\tan\theta - \frac{10x^2}{2 \times 20^2}(1 + \tan^2\theta) = x\tan\theta - \frac{x^2}{80}(1 + \tan^2\theta) \]

\textbf{步骤2：}使用包络线求法

设 $k = \tan\theta$，则：
\[ F(x, y, k) = y - xk + \frac{x^2}{80}(1 + k^2) = 0 \]

对 $k$ 求偏导：
\[ \frac{\partial F}{\partial k} = -x + \frac{x^2k}{40} = 0 \]

当 $x \neq 0$ 时：
\[ k = \frac{40}{x} \]

\textbf{步骤3：}代入求包络线方程

\[ y = x \cdot \frac{40}{x} - \frac{x^2}{80}\left(1 + \left(\frac{40}{x}\right)^2\right) = 40 - \frac{x^2}{80} - \frac{1600}{80} = 40 - \frac{x^2}{80} - 20 = 20 - \frac{x^2}{80} \]

\textbf{答案：}包络线方程为 $y = 20 - \frac{x^2}{80}$。

\textbf{步骤4：}分析可达区域

\begin{itemize}
    \item 顶点：$(0, 20)$，最大高度为 $20$ 米
    \item 与 $x$ 轴交点：$x = \pm 40$，最大水平距离为 $40$ 米
    \item 可达区域：包络线下方（包括边界）的区域
\end{itemize}
\end{examplebox}

\begin{examplebox}{例题2：判断点是否可达}
\textbf{题目：}在例题1的条件下，判断点 $P(30, 10)$ 是否可达？如果可达，求到达该点的抛射角。

\textbf{解：}

\textbf{方法1：}判断点是否在包络线下方

包络线方程为 $y = 20 - \frac{x^2}{80}$。

当 $x = 30$ 时，包络线上的 $y$ 值为：
\[ y = 20 - \frac{30^2}{80} = 20 - \frac{900}{80} = 20 - 11.25 = 8.75 \]

点 $P(30, 10)$ 的 $y$ 坐标为 $10 > 8.75$，说明该点在包络线上方，\textbf{不可达}。

\textbf{方法2：}使用判别式法

将点 $P(30, 10)$ 代入轨迹方程：
\[ 10 = 30\tan\theta - \frac{30^2}{80}(1 + \tan^2\theta) \]

整理得：
\[ 10 = 30k - \frac{900}{80}(1 + k^2) = 30k - \frac{45}{4}(1 + k^2) \]

\[ 40 = 120k - 45(1 + k^2) = 120k - 45 - 45k^2 \]

\[ 45k^2 - 120k + 85 = 0 \]

判别式：
\[ \Delta = 120^2 - 4 \times 45 \times 85 = 14400 - 15300 = -900 < 0 \]

判别式小于零，说明不存在实数解，因此点 $P(30, 10)$ \textbf{不可达}。
\end{examplebox}

\begin{examplebox}{例题3：求到达包络线上某点的抛射角}
\textbf{题目：}在例题1的条件下，求到达包络线上点 $Q(20, 15)$ 的抛射角。

\textbf{解：}

\textbf{步骤1：}验证点在包络线上

当 $x = 20$ 时，包络线上的 $y$ 值为：
\[ y = 20 - \frac{20^2}{80} = 20 - 5 = 15 \]

点 $Q(20, 15)$ 确实在包络线上。

\textbf{步骤2：}求对应的 $k = \tan\theta$

由包络线的推导过程，$k = \frac{v_0^2}{gx} = \frac{40}{20} = 2$

\textbf{步骤3：}求抛射角

\[ \theta = \arctan(2) \approx 63.4° \]

\textbf{答案：}到达点 $Q(20, 15)$ 的抛射角约为 $63.4°$。

\textbf{验证：}将 $\theta = \arctan(2)$ 代入轨迹方程验证即可。
\end{examplebox}

\begin{notebox}{重要注意事项}
\begin{enumerate}
    \item \textbf{包络线的适用范围}：包络线方程是在理想条件下推导的（忽略空气阻力、假设重力加速度恒定等）。实际应用中需要考虑这些因素。
    
    \item \textbf{可达区域的判断}：判断点 $(x, y)$ 是否可达，只需检查是否满足 $y \leq \frac{v_0^2}{2g} - \frac{gx^2}{2v_0^2}$。
    
    \item \textbf{包络线上的点}：包络线上的每个点（除顶点外）通常对应两个对称的抛射角，一个在 $0°$ 到 $45°$ 之间，一个在 $45°$ 到 $90°$ 之间。
    
    \item \textbf{最大射程}：虽然单个轨迹的最大射程在 $\theta = 45°$ 时取得，但包络线与 $x$ 轴的交点对应的是水平抛射（$\theta = 0°$）的射程。
    
    \item \textbf{单位一致性}：计算时注意物理量的单位要一致，通常使用国际单位制（SI）。
\end{enumerate}
\end{notebox}

% ============================================
% 总结
% ============================================
\section{总结}

本笔记介绍了固定速度抛射的包络线问题，主要内容包括：

\begin{itemize}
    \item \textbf{包络线的概念}：与一族曲线都相切的曲线，表示可达区域的边界
    \item \textbf{抛体运动基础}：参数方程、轨迹方程、射程和最大高度
    \item \textbf{轨迹族}：固定初速度、不同抛射角形成的抛物线族
    \item \textbf{包络线方程}：$y = \frac{v_0^2}{2g} - \frac{gx^2}{2v_0^2}$
    \item \textbf{几何性质}：顶点、对称轴、与坐标轴的交点
    \item \textbf{应用}：判断点是否可达、求最优抛射角等
\end{itemize}

包络线问题将数学中的曲线族理论与物理中的抛体运动相结合，是数学物理交叉应用的典型例子。掌握包络线的求法和性质，有助于深入理解抛体运动的本质特征。

% ============================================
% 文档结束
% ============================================
\end{document}
