# 数学笔记 XeLaTeX 模板使用说明

## 模板简介

这是一个专为数学笔记设计的 XeLaTeX 模板，基于 `mathnote-preamble.tex` 导言区构建。模板提供分层色彩、统一的笔记盒、TikZ 样式以及屏幕/印刷双通道支持。

## 编译方式

使用 XeLaTeX 编译：
```bash
xelatex 数学笔记模板.tex
```

建议编译两次以获得正确的目录和交叉引用：
```bash
xelatex 数学笔记模板.tex
xelatex 数学笔记模板.tex
```

## 模板特性

### 1. 文档类
- 使用 `ctexart` 文档类，自动支持中文

### 2. 颜色主题
模板内置现代低饱和度配色，并保持屏幕与 CMYK 输出的亮度一致：
- `accent`: 主色，用于章节标题、定理盒
- `secondary`: 次要强调色，用于定义、辅助说明
- `highlight`: 高光橙色，用于示例、提示
- `inkgray`: 中性文字色，用于页眉、注释
- `surface`: 背景底色，提升对比度

### 3. 专用环境

#### 定义环境
```latex
\begin{definitionbox}{定义标题}
内容...
\end{definitionbox}
```

#### 定理环境
```latex
\begin{theorembox}{定理标题}
内容...
\end{theorembox}
```

#### 例题/技巧环境
```latex
\begin{examplebox}{例题标题}
内容...
\end{examplebox}
```

#### 引理环境
```latex
\begin{lemmabox}{引理标题}
内容...
\end{lemmabox}
```

#### 注意环境
```latex
\begin{notebox}{注意标题}
内容...
\end{notebox}
```

所有彩色盒子默认支持自动分页（`breakable`），长内容不会越页被截断；左侧色条与细线框用于保持层次。

#### 总结环境
```latex
\begin{summarybox}{关键要点}
内容...
\end{summarybox}
```

#### 关键词高亮
```latex
在证明的关键步骤使用 \keyword{关键词} 可以快速定位重点。
```

### 4. 屏幕/印刷模式切换

- 默认以 sRGB 色域显示，亮度友好、适合屏幕阅读；
- 若需要 CMYK 输出，在 `\input{mathnote-preamble.tex}` 之后、`\begin{document}` 之前调用：
  ```latex
  \MathNoteEnablePrint
  ```
  该命令会重新映射配色，限制油墨总量，并同步更新 `hyperref` 链接颜色。

### 5. 信息层级辅助
- `\inlinehint{文字}`：以无衬线小字提示，兼容双模式；
- `\keyword{关键字}`：以主题色加粗；
- `focuspoints`：用于列出排查或推演节点；
- `\PageTag{文本}`：在当前页右上角添加浮动标签，常用于阶段标识。

### 6. 数学定理环境

模板还提供了标准的 amsthm 定理环境：
- `\begin{theorem}...\end{theorem}` - 定理
- `\begin{definition}...\end{definition}` - 定义
- `\begin{lemma}...\end{lemma}` - 引理
- `\begin{corollary}...\end{corollary}` - 推论
- `\begin{example}...\end{example}` - 例题

### 7. 绘图支持

模板支持 TikZ 绘图，可以绘制函数图像、几何图形等。

### 8. 页面设置

- A4 纸张
- 页边距：上下 2.5cm，左右 2cm
- 字体大小：11pt

### 9. 元信息与页眉

在导言区通过以下命令配置标题信息，所有页面会自动在页眉/页脚中显示：
```latex
\renewcommand{\notetitle}{数学笔记标题}
\renewcommand{\noteauthor}{作者姓名}
\renewcommand{\notedate}{\today}
```

页眉左侧为整本笔记标题，右侧为当前章节；页脚显示作者与“当前页/总页数”。

### 10. 常用命令

模板预置数学命令，保证符号一致：
```latex
\R,\C,\Q,\Z,\N,\dd x,\abs{z},\norm{\mathbf{v}}
```
可使用 `\DeclarePairedDelimiter` 提供的星号形式（如 `\abs*{...}`）自动调节括号大小。

## 使用示例

### 基本结构

```latex
\documentclass[a4paper, 11pt]{ctexart}
\input{mathnote-preamble.tex}
% \MathNoteEnablePrint  % 若需要 CMYK 输出

\begin{document}

\title{\Huge \bfseries \color{accent} 你的标题}
\author{你的名字}
\date{\today}
\maketitle

\tableofcontents
\newpage

\section{章节标题}
\subsection{小节标题}

\begin{definitionbox}{定义标题}
定义内容...
\end{definitionbox}

\begin{theorembox}{定理标题}
定理内容...
\end{theorembox}

\end{document}
```

### 数学公式示例

```latex
% 行内公式
设函数 $f(x) = x^2 + 1$。

% 独立公式
\begin{equation}
    \sin^2\alpha + \cos^2\alpha = 1
\end{equation}

% 多行公式
\begin{align}
    \sin(\alpha \pm \beta) &= \sin\alpha\cos\beta \pm \cos\alpha\sin\beta \\
    \cos(\alpha \pm \beta) &= \cos\alpha\cos\beta \mp \sin\alpha\sin\beta
\end{align}
```

### TikZ 绘图示例

```latex
\begin{center}
\begin{tikzpicture}[mathnote lines, scale=1]
    % 坐标轴
    \draw[->, thick] (-2,0) -- (3,0) node[right] {$x$};
    \draw[->, thick] (0,-1) -- (0,3) node[above] {$y$};
    
    % 函数图像
    \draw[accent, thick, domain=-1.5:2.5, samples=100] 
        plot (\x, {(\x-0.5)^2 + 0.5});
\end{tikzpicture}
\captionof{figure}{函数图像}
\end{center}
```

## 自定义修改

### 修改笔记元信息

在导言区重定义 `\notetitle`、`\noteauthor`、`\notedate`：
```latex
\renewcommand{\notetitle}{高等数学笔记}
\renewcommand{\noteauthor}{张三}
\renewcommand{\notedate}{2024.06}
```

### 修改颜色

在 `mathnote-preamble.tex` 中调整屏幕/印刷两套基色，例如：
```latex
\definecolor{screenAccent}{HTML}{0055A4}
\definecolor{printAccent}{cmyk}{1,0.45,0,0.05}
```
或在主文件中局部覆盖
```latex
\colorlet{accent}{teal!65!black}
\MathNoteRefreshColors
```
以同步更新盒子与链接配色。

### 修改页边距

在 `geometry` 设置中修改：
```latex
\geometry{left=2cm, right=2cm, top=2.5cm, bottom=2.5cm}
```

### 修改字体大小

在文档类选项中修改：
```latex
\documentclass[a4paper, 12pt]{ctexart}  % 改为 12pt
```

## 注意事项

1. 确保使用 XeLaTeX 编译，不要使用 pdfLaTeX
2. 如果中文字体显示不正确，可能需要安装中文字体或修改字体设置
3. 某些复杂的 TikZ 图形可能需要多次编译
4. 目录需要编译两次才能正确显示

## 常见问题

### Q: 编译时提示找不到字体？
A: 检查系统是否安装了中文字体。如果使用 Windows，通常使用默认字体即可。如果需要指定字体，可以修改 `\setCJKmainfont` 命令。

### Q: 如何添加自定义环境？
A: 参考模板中的 `\newtcolorbox` 命令创建新的环境，设置合适的颜色和样式。

### Q: 如何移除目录？
A: 删除或注释掉 `\tableofcontents` 这一行。

## 参考

本模板基于以下数学笔记文件的结构：
- `三角函数.tex`
- `以高等数学视角看待函数.tex`
- `常用初等函数衍生函数.tex`




